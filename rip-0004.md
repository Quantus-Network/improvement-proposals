<pre>
  RIP: 4
  Title: ZK-Wormhole: Re-Mining Coins For Privacy
  Author: Chris Smith <chris@resonancenetwork.io>
  Comments-Summary: No comments yet.
  Comments-URI: https://gitlab.com/resonance-network/improvement-proposals/-/wikis/Comments:RIP-0002
  Status: Draft
  Type: Standards
  Created: 2025-14-05
</pre>

## Abstract

## Motivation

## Specification

<img src=rip-0004/circuit.jpg></img>

## Reference Implementation

We implement this feature [here]().


## Rationale

I did the math, if we only check the last 3 field elements (felts) for equality it works out that...
the trie should not be so large that the leaf partial key has less than 3 felts until we have 2^32 ~= 4.3B
an attacker trying to falsify the proof has to find a collision on 2^192 preimages, so ~96 bits of security

This also means we don't have to split felts in the circuit, we can just take the last 3 after poseidon gives us 4.
If we do approach that many wormhole txs, then we can reconfigure poseidon to output 8 felts for the leaf hash



## Copyright

This specification is released into the public domain.

