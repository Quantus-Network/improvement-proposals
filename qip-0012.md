<pre>
  QIP: 12
  Title: Quantum-Secure Bridge
  Author: Chris Smith <chris@quantus.com>
  Comments-Summary: No comments yet.
  Comments-URI: https://github.com/Quantus-Network/improvement-proposals/discussions/
  Status: Draft
  Type: Standards
  Created: 2025-08-19
</pre>

## Abstract

This document describes a design for a quantum-secure bridge between blockchains, using the Hyperlane bridge protocol.

## Motivation

If properly constructed, each blockchain is a self-consistent system where contradictions are all eventually resolved.
Maintaining consistent state across different blockchains via bridges remains a challenge as the bridge will generally 
be less secure than the chains it connects. At the same time, bridges are choke-points for capital and therefore attractive
targets for hackers. 

Bridges generally work by locking or burning tokens on the origin chain and unlocking or minting coins on the destination 
chain. Off chain computers (called "validators" in Hyperlane) attest to (sign a message claiming) the inclusion of the 
transaction on the origin chain and that attestation is sent to the destination chain (via "relayers" in Hyperlane). 
Each of these parties has a key that could be compromised by a quantum computer if it uses pre-quantum cryptography.

There have been numerous bridge hacks with losses reaching into the billions. The emerging quantum threat affects bridges 
in the same way that it affects blockchains, thru the digital signatures. Forgeries of digital signatures on a bridge 
can be categorized as follows:

1. Forgery of sender's signature
2. Forgery of recipient's signature
3. Forgery of admin's signature
4. Forgery of validator's signature
5. Forgery of relayer's signature

For the sender and recipient, these failure modes are identical to the failure mode for signature forgery on the source
and destination blockchains, respectively. 

If there is an admin key that can unlock or mint funds on either chain, a single forgery could lead to tremendous losses. 
This key is called the "owner" key in Hyperlane, and it can be revoked.

Many bridge implementations involve multiple validators, using a threshold signature scheme. A sufficient number of forgeries 
from the various validators would enable an attacker to attest to transactions that did not get included in the chain, 
allowing unauthorized unlocking or minting of coins. In some bridge protocols, such as Hyperlane, such an attack is 
[detectable](https://docs.hyperlane.xyz/docs/protocol/ISM/economic-security/overview#verifiable-fraud-proofs) and punishable via [slashing](https://docs.hyperlane.xyz/docs/protocol-economics/intro#slashing) of 
staked HYPER tokens, but it is still a very undesirable outcome. 

Forgery of a relayer's signature is generally irrelevant in the Hyperlane model. They sign a message to pay gas fee but 
their signatures are not involved in the security model of the bridge. 

These attack vectors make it desirable to build a bridge that at least reduces the attack surface exposed to a quantum attacker.


## Specification

This protocol builds on the [Hyperlane Protocol](https://docs.hyperlane.xyz/). In our protocol, we assume one of the 
chains uses post-quantum-cryptography and the other does not. We make the following modifications to a standard Hyperlane
route:

- Custom validator that does attestations 
- Custom [Interchain Security Module(ISM)](https://docs.hyperlane.xyz/docs/protocol/ISM/standard-ISMs/multisig-ISM) on both Solana and Substrate that verifies dilithium signatures from validators
- Custom Hyperlane "Mailbox" for Substrate

Due to stack-size restrictions in Solana, we use dilithium3 signatures for attestations. This allows us to have a custom
ISM that validates dilithium signatures on both chains. 

Hyperlane does not currently support any Substrate chains, so we implement both the mailbox pattern and the dilithium ISM. 


## Reference Implementation

Not implemented yet

## Rationale

We of course do not have full control over the pre-quantum chain Solana, so we cannot enforce post-quantum signatures for 
senders from that side. Using post-quantum signatures everywhere else largely mitigates the issues, as the only failure mode is
1 (see above). 

The other failure modes are prevented by this scheme as follows
2. Recipient uses dilithium signatures
3. Admin key is burned on both chains
4. Validators use dilithium signatures
5. Relayers don't have any power to corrupt the system

We think this is acceptable as a quantum attacker can only steal keys on Solana and move stolen funds across the bridge.


## Copyright

This specification is released into the public domain.
