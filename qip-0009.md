<pre>
  QIP: 9
  Title: Time-Scheduled Transactions
  Author: Chris Smith <chris@quantus.com>
  Comments-Summary: No comments yet.
  Comments-URI: https://github.com/Quantus-Network/improvement-proposals/discussions/
  Status: Draft
  Type: Standards
  Created: 2025-08-11
</pre>

## Abstract

This document describes a modification to the [scheduler-pallet](https://github.com/paritytech/polkadot-sdk/tree/master/substrate/frame/scheduler) from Substrate to allow scheduling using time instead of block-number.

## Motivation

The scheduler pallet is well tested in Substrate and is primarily used in Polkadot for governance. It schedules based on block-number, which is reasonably predictable for proof-of-stake, but less so for proof-of-work. Over longer periods, the variance of individual block times accumulates (Var(independent sum) = sum(Var)), making long term planning difficult. Additionally, casual users of a blockchain may not understand the concept of blocks or block-numbers, making the drifting timetables confusing.

Although the precision is bounded by target block time, this bound does not increase with time. Target block times are also subject to change with a governance vote, so time based scheduling also avoids any issues that would arise in this case.


## Specification

We introduce a few targeted changes to the scheduler pallet:
- An enum [BlockNumberOrTimestamp](https://github.com/Quantus-Network/chain/blob/main/primitives/scheduler/src/lib.rs#L42) as an abstraction layer that allows users to schedule transactions based on either block-number or timestamp.
- A [pallet config TimestampBucketSize](https://github.com/Quantus-Network/chain/blob/main/pallets/scheduler/src/lib.rs#L276), which determines the resolution of time-based scheduling.
- The block hook [on_initialize](https://github.com/Quantus-Network/chain/blob/main/pallets/scheduler/src/lib.rs#L368) we separate service_agenda into two functions, service_block_agendas and service_timestamp_agendas.


## Reference Implementation

The time-based scheduler pallet is implemented [here](https://github.com/Quantus-Network/chain/tree/main/pallets/scheduler).

## Rationale

The modified scheduler pallet allows scheduling with both block-numbers and timestamps so that the governance system will not require any modification.

Due to the Nyquist sampling theorem, the maximum sensible resolution of TimestampBucketSize is half the target block time, but this is not enforced.

Splitting the block hook into two servicing functions gives no preference to block-based or time-based schedules.

## Copyright

This specification is released into the public domain.
