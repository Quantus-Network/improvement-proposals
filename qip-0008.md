<pre>
  QIP: 8
  Title: Checkphrase: A Human Readable Checksum
  Author: Chris Smith <chris@quantus.com>
  Comments-Summary: No comments yet.
  Comments-URI: https://github.com/Quantus-Network/improvement-proposals/discussions/
  Status: Draft
  Type: Standards
  Created: 2025-08-07
</pre>

## Abstract

This document describes a human readable checksum for use in cryptographic applications where a human must check the integrity of data. The checksum is generated using a cryptographic hash function and is represented as a sequence of words that are easy for humans to remember and verify.

## Motivation

Blockchains use hash functions in many different ways, from generating unique identifiers to hiding information while still tracking it. The most common example of this is the blockchain address, which is typically the hash of a public key with some additional information, including a checksum. The [Bitcoin address checksum](https://bitcoin.stackexchange.com/questions/32353/how-do-i-check-the-checksum-of-a-bitcoin-address), for example, is an extra 4 bytes on the end of the address meant to protect against accidental errors in the data, such as typos or bit flips, but its small size does not protect against malicious tampering. Likewise Ethereum's address has a [unique checksum](https://github.com/ethereum/ercs/blob/master/ERCS/erc-55.md) in which the capitalization of the letters in the hash is determined by the hash of the address. This checksum does protect against malicious tampering, but it is not easy to read for humans.

The issue of address integrity is paramount for usability in blockchains. "Address poisoning" attacks have cost users millions by creating attacker-controlled addresses that begin and end with the same letters as the user's address and swapping these malicious addresses in via malware. To make matters worse, many wallets do not show the entire address without some effort, they show the first and last few letters with "..." to summarize the middle.

Address poisoning attacks can be mitigated by using a cryptographically-secure human-readable checksum. This checksum is generated using a cryptographic hash function and is represented as a sequence of words that are easy for humans to remember and verify, using the same principle (and word list!) a the [BIP39](https://github.com/bitcoin/bips/blob/master/bip-0039.mediawiki) mnemonic phrase.

## Specification

Essentially, we use PBKDF2-HMAC-SHA256 with 40k iterations and the salt "human-readable-checksum" to generate a unique 7-byte hash specific to the address. We then use this hash to randomly select 5 words from the 2048 word list used to make BIP39 phrases.

This check-phrase is shown to the user wherever the address is displayed.

## Reference Implementation

The check-phrase is implemented [here](https://github.com/Quantus-Network/human-checkphrase).

## Rationale

We use PBKDF2-HMAC-SHA256 because it requires sequential hashing of the input, which makes it more resistant to brute-force attacks. The number of iterations (40k) is chosen to make it quick to generate dynamically in UIs, while still requiring a very long time to generate a rainbow-table. The salt makes it even less likely that an attacker would have already generated a rainbow-table that contains the hash of the address. The number of words is chosen to be 5 to ensure a high level of security while still being easy to read, say and remember.

## Copyright

This specification is released into the public domain.
